
# CH09. Git 병합 및 충돌 해결 

<br>
<br>

Git에서 병합(Merge)은 두 개의 브랜치의 변경 사항을 하나로 합치는 작업입니다. 병합 과정에서 동일한 파일의 동일한 부분이 여러 브랜치에서 수정된 경우 충돌이 발생할 수 있습니다. 

여기서는 병합과 충돌 해결에 대한 주요 명령어와 종합 예시를 다루겠습니다.

<br>  

## 1. 병합 명령어

  

#### **1)**  git merge:   다른 브랜치의 변경 사항을 현재 브랜치에 병합합니다.

```
git merge <branch-name>
```

<br>

#### 2)  git merge --abort:   병합 도중 충돌이 발생한 경우 병합을 중단하고 이전 상태로 되돌립니다.

```
git merge --abort
```

<br>
<br>

## 2. 충돌 해결 명령어

#### **1)**  git status:   충돌이 발생한 파일을 확인합니다.

```
git status
```

<br>

#### 2)  수동으로 충돌 해결: 충돌이 발생한 파일을 열어 수정합니다. 충돌 부분은 아래와 같이 표시됩니다.


```
<<<<<<< HEAD
코드 A (현재 브랜치)
=======
코드 B (병합된 브랜치)
>>>>>>>
```

<br>

#### 3)  git add: 충돌을 해결한 파일을 스테이징합니다.

```
git add <resolved-file>
```

<br>

#### 4)  git commit: 충돌 해결 후 변경 사항을 커밋합니다.

```
git commit
```

<br>
<br>

## 3. 실습 예제(1)

<br>

### 1) Git 병합 관련 주요 명령어는 다음과 같습니다:

<br>

1. `git merge <branch_name>`: 현재 브랜치에 다른 브랜치를 병합합니다. 병합 과정에서 충돌이 발생할 수 있습니다.
2. `git rebase <branch_name>`: 현재 브랜치를 다른 브랜치에 리베이스합니다. 리베이스는 커밋 히스토리를 재작성하므로 주의가 필요합니다.
3. `git pull`: 원격 저장소의 변경사항을 가져와 현재 브랜치에 병합합니다.

  
<br>
  

### 2) 충돌 발생 시 해결 방법은 다음과 같습니다:

<br>

1. `git status`: 충돌이 발생한 파일을 확인합니다.
2. 충돌이 발생한 파일을 열어 충돌 부분을 직접 수정합니다.
3. `git add <conflicted_files>`: 수정된 파일을 Staging Area에 추가합니다.
4. `git commit`: 충돌 해결 후 커밋합니다.
  
<br>

```
# 메인 브랜치
mkdir git-merge-example
cd git-merge-example
git init
touch README.md
git add README.md
git commit -m "Initial commit"

# 기능 브랜치 생성 및 작업
git checkout -b feature/add-login
echo "Login functionality" >> README.md
git add README.md
git commit -m "Add login functionality"

# 메인 브랜치 변경사항
git checkout main
echo "This is the main branch." >> README.md
git add README.md
git commit -m "Update README.md on main branch"

# 기능 브랜치 병합 시 충돌 발생
git merge feature/add-login
# 충돌 해결을 위해 README.md 파일 수정
# <<<<<<< HEAD
# This is the main branch.
# =======
# Login functionality
# >>>>>>> feature/add-login

git add README.md
git commit -m "Resolve merge conflict"

# 병합 완료
git log --oneline --graph --all
```

<br>
<br>  

## 4. 실습 예제(2)

<br>

### 1) 시나리오

- 두 명의 개발자가 동일한 파일을 각각 다른 브랜치에서 수정하고, 이를 병합하는 과정에서 충돌이 발생하는 상황을 가정합니다.
  
<br>  

### 2) 실습내용  

#### A. 프로젝트 초기화 및 첫 커밋

```
mkdir git-merge-conflict-example
cd git-merge-conflict-example
git init
echo "Initial content" > example.txt
git add example.txt
git commit -m "Initial commit"
```

<br>

#### B. 새로운 브랜치 생성 및 수정

```
# 첫 번째 브랜치 생성 및 수정
git checkout -b feature-1
echo "Feature 1 content" > example.txt
git add example.txt
git commit -m "Add feature 1 content"

# 두 번째 브랜치 생성 및 수정
git checkout main
git checkout -b feature-2
echo "Feature 2 content" > example.txt
git add example.txt
git commit -m "Add feature 2 content"
```

<br>

  

#### C. 브랜치 병합 및 충돌 발생

```
# 메인 브랜치로 돌아가서 feature-1 병합
git checkout main
git merge feature-1

# feature-2 병합 시도 (충돌 발생)
git merge feature-2
```

<br>

#### \* 예상 결과:

<br>

```
Auto-merging example.txt
CONFLICT (content): Merge conflict in example.txt
Automatic merge failed; fix conflicts and then commit the result.
```
  
<br>  

#### D. 충돌 해결

```
# 충돌 상태 확인
git status
# On branch main
# You have unmerged paths.
#   (fix conflicts and run "git commit")
#   (use "git merge --abort" to abort the merge)
#
# Unmerged paths:
#   (use "git add <file>..." to mark resolution)
# 	both modified:   example.txt
#
# no changes added to commit (use "git add" and/or "git commit -a")

# 충돌 파일 수정 (example.txt)
vim example.txt
# 내용 수정 후:
# <<<<<<< HEAD
# Feature 1 content
# =======
# Feature 2 content
# >>>>>>>
# 수정된 내용 예시:
# Feature 1 content
# Feature 2 content

# 수정된 파일 스테이징
git add example.txt

# 병합 커밋
git commit -m "Merge feature-2 into main with conflict resolution"
```

<br>

#### 결과 확인

```
# 로그 확인
git log --oneline
```

<br>

예상 결과:

```
# 커밋 로그에 병합 커밋 포함
# <new-commit-hash> Merge feature-2 into main with conflict resolution
# <feature-2-commit-hash> Add feature 2 content
# <feature-1-commit-hash> Add feature 1 content
# <initial-commit-hash> Initial commit
```

###   

###   

### 3) 요약

- **병합 (git merge)**: 다른 브랜치의 변경 사항을 현재 브랜치에 병합합니다.
- **충돌 해결**: 충돌 발생 시, `git status`로 충돌 파일 확인 후, 파일을 수정하고 `git add`로 스테이징 후 커밋합니다.
- **병합 중단 (git merge --abort)**: 병합 도중 충돌이 발생하여 중단하고 싶을 때 사용합니다.