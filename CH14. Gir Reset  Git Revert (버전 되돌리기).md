
# CH15. Git Reset | Git Revert (버전 되돌리기)

<br>
<br>  

`GIT`으로 로컬저장소에 커밋된 파일들은 다른 작업을 진행 중이더라도 언제든지 이전에기록한 파일의 버전으로 돌아갈 수 있습니다.  
작업중인 파일에 문제가 생겼거나 버전을 롤백해야 하는 상황이 왔을 때 이전 버전으로 돌아가는 방법을 알아보겠습니다.

버전을 이동할 수 있는 `checkout` 명령어와는 조금 다릅니다.

<br>

## 1. Git Reset

<br>

### 1) 소개

`git reset` 명령어는 브랜치의 현재 상태를 이전 커밋 상태로 되돌립니다. 이 명령어는 주로 로컬 리포지토리에서 작업할 때 사용되며, 작업 내역을 변경하거나 삭제할 수 있습니다.

`git reset`에는 세 가지 주요 모드가 있습니다: `--soft`, `--mixed`, `--hard`.

<br>

- `commit` 버전을 이동시키는 명령어
- 이전 버전으로 이동할 떄, 이전 버전 이후에 작업한 모든 `commit`은 삭제 됩니다.
- 주로 `branch`를 혼자 사용하거나 로컬저장소에서 사용 된다. ( 협업시 사용 비추 )

<br>  

![](https://velog.velcdn.com/images/devp1023/post/cdabbf27-38fe-4234-9fba-871a1f61d25d/image.png)  

  
<br>
  

### 2) 사용법

  

1. `--soft` 모드

이 모드는 브랜치의 헤드를 지정된 커밋으로 이동시키지만, 스테이징 영역과 작업 디렉토리는 변경하지 않습니다. 즉, 커밋을 되돌리지만 변경된 파일은 그대로 남아 있습니다.  

```
git reset --soft <commit>
```

<br>  

2. `--mixed` 모드 (기본 모드)

이 모드는 브랜치의 헤드를 지정된 커밋으로 이동시키고, 스테이징 영역은 초기화하지만 작업 디렉토리는 변경하지 않습니다. 즉, 커밋을 되돌리고 스테이징 영역을 초기화하지만 변경된 파일은 그대로 남아 있습니다.

```
git reset --mixed <commit>
```

<br>

  

3. `--hard` 모드

이 모드는 브랜치의 헤드를 지정된 커밋으로 이동시키고, 스테이징 영역과 작업 디렉토리를 모두 초기화합니다. 즉, 커밋을 되돌리고 모든 변경 사항을 삭제합니다.  

```
git reset --hard <commit>
```

<br>
  

### 3) 예제

```
# 가장 최근 커밋을 되돌리고 변경 사항을 유지 (스테이징 영역 및 작업 디렉토리 유지)
git reset --soft HEAD~1

# 가장 최근 커밋을 되돌리고 변경 사항을 스테이징 해제 (작업 디렉토리 유지)
git reset --mixed HEAD~1

# 가장 최근 커밋을 되돌리고 모든 변경 사항을 삭제 (스테이징 영역 및 작업 디렉토리 초기화)
git 
```

<br>
<br>   

## 2. Git Revert

<br>

### 1) 소개

`git revert` 명령어는 지정된 커밋을 취소하는 새로운 커밋을 생성합니다. 이 명령어는 원래 커밋을 유지하면서 취소 작업을 기록하기 때문에, 협업 프로젝트에서 안전하게 사용할 수 있습니다.

<br>

- 과거에 특정한 `commit` 버전을 없었던 일로 만드는 행위
- 새로운 버전에 이전 버전에서 수정된 내용만 가져 옵니다.
- 버전을 이동할 때, 이동한 버전 이후에 생긴 `commit` 파일에 영향을 주지 않습니다.→ 이 부분이 reset과 다른 점
- 이전 버전으로 돌아갈 때 역순으로 차근차근 `revert` 해야 충돌이 나지 않습니다.

<br>

![](https://velog.velcdn.com/images/devp1023/post/1a1e4e02-7e58-4b15-ad12-45d2f20e54b5/image.png)

<br>  

### 2) 사용법

1. 기본 사용법

```
git revert <commit>
```  

이 명령어는 지정된 커밋의 변경 사항을 되돌리는 새로운 커밋을 생성합니다.

<br>  

2. 여러 커밋 되돌리기

여러 커밋을 한 번에 되돌릴 수도 있습니다. `-n` 또는 `--no-commit` 옵션을 사용하여 모든 변경 사항을 스테이징 영역에 모아두고, 한 번에 커밋할 수 있습니다.  

```
git revert -n <commit1> <commit2> ...
git commit -m "Reverted multiple commits"
```

<br>  

### 3) 예제

```
# 특정 커밋을 되돌리는 새로운 커밋 생성
git revert abc1234

# 마지막 두 개의 커밋을 되돌리고 하나의 커밋으로 합치기
git revert -n HEAD~2..HEAD
git commit -m "Reverted last two commits"
```

<br>  

### 4) 요약

- `git reset`: 브랜치의 현재 상태를 이전 커밋 상태로 되돌리며, 주로 로컬 변경 사항을 조정하거나 제거하는 데 사용됩니다. `--soft`, `--mixed`, `--hard` 모드를 사용하여 되돌릴 범위를 선택할 수 있습니다.
- `git revert`: 지정된 커밋을 취소하는 새로운 커밋을 생성하여 안전하게 변경 사항을 되돌립니다. 협업 환경에서 주로 사용됩니다.

  
<br>
<br>

  

## 3. 실습 예제

<br>

Git의 `reset`과 `revert` 명령어를 사용하여 버전을 되돌리는 실습 예제를 단계별로 설명하겠습니다. 이 예제는 간단한 Git 리포지토리를 만들어 여러 커밋을 만든 후,   
각 명령어를 사용하여 커밋을 되돌리는 과정을 포함합니다.

  

### 실습 환경 준비

<br>

새 디렉토리와 Git 리포지토리 생성  

```
mkdir git-revert-reset-demo
cd git-revert-reset-demo
git init
```

<br>  

### Step 1: 몇 가지 커밋 만들기  

1. 파일 생성 및 첫 번째 커밋

```
echo "First version of the file" > file.txt
git add file.txt
git commit -m "Initial commit"
``` 

2. 두 번째 커밋

```
echo "Second version of the file" >> file.txt
git add file.txt
git commit -m "Second commit"
``` 

3. 세 번째 커밋

```
echo "Third version of the file" >> file.txt
git add file.txt
git commit -m "Third commit"
```  

<br>

### Step 2: `git reset` 사용 예제

1. 현재 Git 로그 확인

```
git log --oneline
```

<br>

로그를 보면 세 개의 커밋이 보입니다. 예를 들어:

```
c3d2e19 (HEAD -> main) Third commit
b6f7a8b Second commit
e1c8a07 Initial commit
```  

<br>

2. 마지막 커밋을 되돌리기 (`--soft`)

```
git reset --soft HEAD~1
```  

<br>

이 명령어를 실행하면 마지막 커밋이 되돌려지고, 변경 사항은 스테이징 영역에 남아 있습니다. `git status`를 실행하여 확인할 수 있습니다.

```
git status
```

<br>  

3. 변경 사항 커밋 취소

```
git reset HEAD file.txt
git checkout -- file.txt
```

<br>

4. 마지막 커밋을 되돌리기 (`--hard`)

```
git reset --hard HEAD~1
```

<br>

이 명령어를 실행하면 마지막 커밋이 되돌려지고, 변경 사항이 완전히 삭제됩니다. 다시 `git log`를 확인해보세요.

<br>
  

### Step 3: `git revert` 사용 예제

  

1. 두 번째 커밋 되돌리기

현재 상태에서 다시 두 번째 커밋을 만들어봅니다.  

```
echo "Second version of the file" >> file.txt
git add file.txt
git commit -m "Second commit"
```

<br>

  

2. 세 번째 커밋 만들기

```
echo "Third version of the file" >> file.txt
git add file.txt
git commit -m "Third commit"
```

<br>

3. 현재 Git 로그 확인

```
git log --oneline
```

<br>

4. 두 번째 커밋 되돌리기

```
git revert HEAD~1
```

<br>

이 명령어를 실행하면 두 번째 커밋의 변경 사항을 취소하는 새로운 커밋이 생성됩니다. 커밋 메시지를 입력하라는 프롬프트가 나타날 것입니다. 메시지를 작성하고 저장하면 됩니다.

<br>
 

### Step 4: 최종 확인  

1. Git 로그 확인

```
git log --oneline
```  

로그를 확인하여 `revert` 커밋이 생성되었는지 확인합니다.

<br>  

2. 파일 내용 확인

```
cat file.txt
```

<br>

파일 내용을 확인하여 원하는 대로 변경되었는지 확인합니다.
  

이 실습을 통해 `git reset`과 `git revert` 명령어를 사용하여 커밋을 되돌리는 방법을 익힐 수 있습니다.

`reset`은 주로 로컬 변경 사항을 수정하거나 제거할 때 사용하고,  `revert`는 협업 환경에서 안전하게 변경 사항을 취소할 때 사용합니다.